CREATE INDEX fpidx ON pgbfp USING gist (f);
SET rdkit.tanimoto_threshold = 0.7;
SET rdkit.dice_threshold = 0.8;
SET enable_indexscan=off;
SET enable_bitmapscan=off;
SET enable_seqscan=on;
SELECT
    id, tanimoto_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) % f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.970238095238095
  4287001 | 0.903614457831325
   689878 | 0.842105263157895
   902176 | 0.837349397590361
   690546 | 0.798994974874372
   661038 | 0.795811518324607
  5161158 | 0.784530386740331
 24761377 |  0.78391959798995
  4440220 | 0.783251231527094
  3218102 |              0.78
(10 rows)

SELECT
    id, dice_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) # f
ORDER BY sml DESC, id;
    id    |        sml        
----------+-------------------
 10560368 | 0.984894259818731
  4287001 | 0.949367088607595
   689878 | 0.914285714285714
   902176 | 0.911475409836066
   690546 | 0.888268156424581
   661038 | 0.886297376093295
  5161158 | 0.879256965944272
 24761377 |  0.87887323943662
  4440220 | 0.878453038674033
  3218102 | 0.876404494382023
   289688 | 0.873900293255132
    66722 | 0.872093023255814
  1941952 | 0.871934604904632
   698576 | 0.871794871794872
 16411727 | 0.868852459016393
  3218145 | 0.868131868131868
   755497 | 0.868035190615836
 16194369 | 0.867469879518072
  1959267 |  0.86685552407932
  1356857 | 0.866666666666667
  9550023 | 0.866096866096866
 16682231 | 0.865671641791045
 22431219 | 0.862857142857143
  3218091 | 0.859598853868195
  3218139 | 0.859598853868195
 24746888 | 0.859598853868195
  2952787 | 0.858858858858859
  2969415 | 0.857142857142857
 16746409 | 0.855491329479769
  1240168 | 0.854545454545454
 24747640 | 0.854489164086687
 16746587 | 0.850439882697947
 18159091 | 0.847953216374269
  2842448 | 0.846796657381616
  2965343 | 0.846625766871166
 16000816 | 0.845714285714286
  5808003 | 0.844919786096257
  9642965 | 0.844919786096257
   887674 | 0.844574780058651
  3963948 | 0.844327176781003
  5281628 | 0.843137254901961
   664261 | 0.842696629213483
   979228 |  0.84180790960452
 16192823 | 0.841791044776119
  2146372 | 0.838888888888889
   644427 | 0.838709677419355
  2546318 | 0.838356164383562
  2677756 | 0.838356164383562
  5224323 | 0.838356164383562
   788060 | 0.837465564738292
  5760981 | 0.836842105263158
 16745509 | 0.835734870317003
  3218123 | 0.835579514824798
 12005091 | 0.835164835164835
  5924924 | 0.834733893557423
  7579125 | 0.834733893557423
 15945163 | 0.834688346883469
 16746238 | 0.834254143646409
  2944357 | 0.833787465940054
 24747689 | 0.832876712328767
 16746589 |   0.8328611898017
 16682521 |             0.832
 16746461 |             0.832
  2766354 | 0.831955922865014
 16746192 | 0.831955922865014
  1098906 | 0.831578947368421
  2731987 | 0.831521739130435
  1548109 |           0.83125
  3218141 | 0.831024930747922
  2931707 | 0.830860534124629
  4209216 | 0.830508474576271
  6108933 |  0.83008356545961
  5638671 |  0.82967032967033
  2976240 | 0.828877005347594
   833787 | 0.828571428571429
  2836255 |          0.828125
  3585388 |  0.82687338501292
  2204903 | 0.826446280991736
 16746235 | 0.825136612021858
  2983507 | 0.825065274151436
  1747332 | 0.824512534818941
  6537645 | 0.824512534818941
 12005462 | 0.824512534818941
  2967649 | 0.824175824175824
  5718132 | 0.824175824175824
   576770 | 0.823863636363636
 16194446 | 0.823863636363636
 16194507 | 0.823863636363636
   645921 | 0.823529411764706
  3218081 | 0.823188405797101
   840468 | 0.822535211267606
   771595 | 0.822222222222222
  1117184 | 0.821917808219178
   645989 | 0.821428571428571
   672053 | 0.821052631578947
  5346524 | 0.820652173913043
  5600863 | 0.820652173913043
 12005392 |  0.82051282051282
 12005480 |  0.82051282051282
  5206420 |  0.81994459833795
  3242387 | 0.819843342036554
  3928077 | 0.819672131147541
   844215 | 0.819484240687679
 11948892 | 0.819148936170213
  2847637 | 0.818181818181818
  2943519 | 0.817708333333333
 16189701 |  0.81767955801105
  2998376 | 0.817204301075269
  3955259 | 0.817142857142857
  5770963 | 0.816976127320955
  6620674 | 0.816976127320955
  3236137 | 0.816666666666667
  8232846 | 0.815426997245179
   289701 |  0.81524926686217
  5770965 | 0.814814814814815
  1954933 | 0.813008130081301
 16746225 | 0.812834224598931
 16745609 | 0.812339331619537
   823695 | 0.812324929971989
   498250 | 0.811428571428571
  1351746 | 0.811428571428571
  3790017 | 0.811369509043928
  2920814 | 0.811111111111111
  5359275 | 0.811111111111111
  5718138 | 0.811111111111111
 16746171 | 0.811111111111111
   752155 | 0.810666666666667
   807628 | 0.810666666666667
  4671908 |  0.81038961038961
 16193886 | 0.810198300283286
  2910597 | 0.809782608695652
  3405433 | 0.809651474530831
  2997950 | 0.809399477806789
  1835325 | 0.809384164222874
 16746183 | 0.808864265927978
 16746205 | 0.808864265927978
 16746207 | 0.808864265927978
 24761084 | 0.808625336927224
  5389081 | 0.808383233532934
  5464092 | 0.808184143222506
 16682422 | 0.808184143222506
 16745686 | 0.808184143222506
  3141521 | 0.808139534883721
  3529948 | 0.808022922636103
 16190759 | 0.807387862796834
   246547 | 0.807017543859649
  3327067 | 0.806539509536785
 16746511 | 0.806451612903226
  1301379 | 0.806045340050378
  1219325 | 0.805714285714286
   647618 | 0.805405405405405
   979929 | 0.805405405405405
   230488 | 0.805333333333333
 17583464 | 0.804938271604938
  2845279 | 0.804733727810651
 16413476 | 0.804733727810651
   687554 | 0.804597701149425
  6036600 | 0.804532577903683
 16746165 | 0.804407713498623
   657589 | 0.803324099722992
  4875255 | 0.803149606299213
   649111 | 0.803030303030303
  6409922 | 0.802395209580838
  3777125 | 0.802292263610315
  5243548 | 0.802228412256267
 16190602 | 0.802139037433155
  6076861 | 0.802083333333333
  6266272 | 0.802083333333333
  9549556 | 0.801186943620178
  1713149 | 0.801120448179272
 15945797 | 0.800995024875622
   341725 |               0.8
  2341508 |               0.8
  2959663 |               0.8
(174 rows)

SET enable_indexscan=on;
SET enable_bitmapscan=on;
SET enable_seqscan=off;
SELECT
    id, tanimoto_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) % f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.970238095238095
  4287001 | 0.903614457831325
   689878 | 0.842105263157895
   902176 | 0.837349397590361
   690546 | 0.798994974874372
   661038 | 0.795811518324607
  5161158 | 0.784530386740331
 24761377 |  0.78391959798995
  4440220 | 0.783251231527094
  3218102 |              0.78
(10 rows)

SELECT
    id, dice_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) # f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.984894259818731
  4287001 | 0.949367088607595
   689878 | 0.914285714285714
   902176 | 0.911475409836066
   690546 | 0.888268156424581
   661038 | 0.886297376093295
  5161158 | 0.879256965944272
 24761377 |  0.87887323943662
  4440220 | 0.878453038674033
  3218102 | 0.876404494382023
(10 rows)

SET enable_indexscan=on;
SET enable_bitmapscan=on;
SET enable_seqscan=on;
DROP INDEX fpidx;
