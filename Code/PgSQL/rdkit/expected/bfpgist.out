CREATE INDEX fpidx ON pgbfp USING gist (f);
SET rdkit.tanimoto_threshold = 0.7;
SET rdkit.dice_threshold = 0.8;
SET enable_indexscan=off;
SET enable_bitmapscan=off;
SET enable_seqscan=on;
SELECT
    id, tanimoto_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) % f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.902777777777778
  4287001 | 0.771551724137931
  1356857 | 0.768924302788845
   690546 | 0.731517509727626
   902176 | 0.725663716814159
    66722 | 0.716535433070866
  2952787 | 0.716157205240175
  4440220 | 0.714828897338403
 24761377 |  0.71264367816092
 16411727 | 0.709923664122137
(10 rows)

SELECT
    id, dice_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) # f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.948905109489051
  4287001 | 0.871046228710462
  1356857 | 0.869369369369369
   690546 | 0.844943820224719
   902176 | 0.841025641025641
    66722 | 0.834862385321101
  2952787 | 0.834605597964377
  4440220 |  0.83370288248337
 24761377 | 0.832214765100671
 16411727 | 0.830357142857143
(10 rows)

SET enable_indexscan=on;
SET enable_bitmapscan=on;
SET enable_seqscan=off;
SELECT
    id, tanimoto_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) % f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.902777777777778
  4287001 | 0.771551724137931
  1356857 | 0.768924302788845
   690546 | 0.731517509727626
   902176 | 0.725663716814159
    66722 | 0.716535433070866
  2952787 | 0.716157205240175
  4440220 | 0.714828897338403
 24761377 |  0.71264367816092
 16411727 | 0.709923664122137
(10 rows)

SELECT
    id, dice_sml(layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol), f) AS sml
FROM
	pgbfp
WHERE layered_fp('O=C1CC(OC2=CC=CC=C12)C1=CC=CC=C1'::mol) # f
ORDER BY sml DESC, id limit 10;
    id    |        sml        
----------+-------------------
 10560368 | 0.948905109489051
  4287001 | 0.871046228710462
  1356857 | 0.869369369369369
   690546 | 0.844943820224719
   902176 | 0.841025641025641
    66722 | 0.834862385321101
  2952787 | 0.834605597964377
  4440220 |  0.83370288248337
 24761377 | 0.832214765100671
 16411727 | 0.830357142857143
(10 rows)

SET enable_indexscan=on;
SET enable_bitmapscan=on;
SET enable_seqscan=on;
DROP INDEX fpidx;
